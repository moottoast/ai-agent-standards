---
description: Apply controller-specific patterns for Rails controllers
globs: ["app/controllers/**/*.rb"]
---

# Rails Controller Standards (Scoped)

## Context

- When creating or modifying Rails controllers.
- Controllers should stay thin; orchestration only.

## Requirements

- Follow RESTful conventions and resource-based naming.
- Use `before_action` for common setup and keep actions small.
- Use `respond_to` only when formats are actually needed by the feature.
- Follow repo conventions for pagination/sorting (e.g., Pagy) when present.
- For non-GET redirects (e.g., after DELETE), prefer `status: :see_other` when the repo uses it; otherwise follow existing patterns.
- Use `status: :unprocessable_entity` for failed creates/updates unless this repo uses a different status convention.
- Use strong params (`params.require(...).permit(...)`) and follow any established patterns (e.g., `params.expect(...)`) in this codebase.
- Handle `ActiveRecord::RecordNotFound` in the repoâ€™s existing way (rescue + 404/redirect).
- Add tests first (per AGENTS.md): prefer request specs for controller behavior.
